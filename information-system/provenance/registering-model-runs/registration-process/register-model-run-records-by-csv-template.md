---
layout: default
title: Register model run records by CSV Templates
nav_order: 3
has_children: false
grand_parent: Registering model runs
parent: Creating and registering model run records
---

{: .no_toc }

<details  open markdown="block">
  <summary>
    Table of contents
  </summary>
{: .text-delta }
* TOC
{:toc}
____
</details>


# Register model run records by CSV Templates

## Overview

The Provenance Store user interface facilitates the registration of provence through the filling and ingestion of CSV templates. These CSV templates are autogenerated from Model Run Workflow Template entities defined in the entity registry.

## Where to do this

This tooling can be found by clicking on the "Provenance Registration Tools" button from the Provenance Store's home page.

## How to register Provenance by CSV


### Create a CSV template (Step 1)
The first step is to obtain a CSV template for you to fill out. As the templates are autogenerated from Model Run Workflow Template entities in the registry, you must first register a Model Run Workflow Template entity. See [here](../model-workflow-configuration#model-run-workflow-template) for help.

### Download the CSV template (Step 2)
Upon successfully creating a Model Run Workflow Template in the entity registry, it will automatically appear in the Provenance Registration Tool when viewing the "Generate CSV Template" side tab. Search for it using its associated ID or name. When you have found it, select "click to download" located at the bottom of the tool box.

### Fill in the CSV template (Step 3)
Opening the template, we see the fields to be filled in listed across the top as headers. Each row that is filled in corresponds to a single Model Run.
Fields beginning with underscores are automatically filled in by the Information System so must not be manually filled in. 

The following provides a brief description on the default fields required by the Provenance System:

**Description**: A brief description of the Model Run.

**Agent ID**: The ID of agent responsible for running the model run. This is the ID of the person/organisation in the entity registry. To obtain an ID for a person, first try [searching](../../registry/exploring_the_registry.md) for them in the registry, if they don't exist, they will need to be registered to create an ID for them. See [here](../establishing-required-entities.md#what-entities-are-required-to-register-provenance) for help on establishing the required entities.

**Requesting Organisation ID**: The ID of the organisation requesting the Model Run. Again, this ID refers to the ID of the organisation in the Entity Registry. To obtain an ID for an organisation, try [searching](../../registry/exploring_the_registry.md) for them first, if they don't exist, they will need to be registered to create an ID for them See [here](../establishing-required-entities.md#what-entities-are-required-to-register-provenance) for help on establishing the required entities.

**Execution Start/End Time**: The respective start and end time of the model run execution.

The format for these a profile of ISO8601 (called RFC 3339) in which a space is allowed to separate the date and time. Additionally, the IS will also accept "/" in the date section, and will allow for the timezone and seconds to be omitted. If the timezone is omitted, UTC will be assumed by the system. If seconds, are omitted, the IS will record 00 for this value. E.g. inputting 2022-11-28 12:23 will go be assumed to equal 2022-11-28 12:23:00+00:00.

Some example formats (for which a 'T' can also be used to separate the date and time):
- YYYY-MM-DD HH:MM:SS+HH:MM
- YYYY/MM/DD HH:MM:SS+HH:MM
- YYYY-MM-DD HH:MM:SS
- YYYY/MM/DD HH:MM:SS
- YYYY-MM-DD HH:MM
- YYYY/MM/DD HH:MM


**Dataset ID for Template XXXXX.X/XXXXXXX**: This refers to the ID of the Dataset being used to fill the template. This requires output datasets to be registered in the datastore to obtain an ID for them.  See [registering a dataset](../../../data-store/registering-a-dataset) for help.


### Uploading the CSV (Step 4)
Once you have filled in at least one row of the dataset template (corresponding to a single run) you can upload this to the provenance store to "lodge" the run and register its provenance.

In the Provenance Registration Tools window, select the Lodge CSV Template from the left side panel.
Select "Choose file" to select the file to upload. Click upload if you're happy with your selection. Observe the number of New and existing records detected in the CSV. To finalised the upload, press "submit" to lodge the CSV and the IS will begin to process the provenance.

### Confirming Success (Step 5)
Upon upload, you will be taken to the following screen where a batch ID is provided for this upload. Press refresh to get a live update of the provenance system processing your provenance. There will be a JOB ID for each new model run (row) in the CSV template you uploaded. And each newly recorded Model Run is generated a unique ID. 

### Re downloading (Step 6)

{% include warning.html content="To avoid duplication of provenance records when appending to a CSV tempalte with existing runs, redownload the template so that recorded entries appear in the template with '_job' fields filled in." %}

After uploading a CSV with model runs, re downloading it using the button below list of Job IDs (or instructions from [Step 2](#download-the-csv-template-step-2)) will include the already registered runs. It is important to use a re-downloaded CSV template when appending new runs into a csv with older (already registerd runs) so as to avoid duplication of provenance records in the system.

### Viewing Job History (Step 7)

The Job History Side tab allows you to view your history of using the CSV ingestion tooling to register provenance records.

Evident is the batch ID, time stamp, and a Job Count which represent the number of records that were created in that batch. Click on an entry to explore it and its contents in more detail.

